<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   Real-Time Messaging
  </title>
  <link href="style.css" rel="stylesheet"/>
 </head>
 <body>
  <div class="container">
   <!-- Welcome Modal -->
   <div class="modal" id="welcomeModal">
    <div class="modal-content">
     <h2>
      Chat Platform
     </h2>
     <p style="margin-bottom: 32px; color: var(--text-secondary);">
      Connect with friends in real-time with style
     </p>
     <button class="btn" onclick="showCreateRoom()">
      <svg class="icon" viewbox="0 0 24 24">
       <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z">
       </path>
      </svg>
      Create Room
     </button>
     <button class="btn btn-secondary" onclick="showJoinRoom()">
      <svg class="icon" viewbox="0 0 24 24">
       <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z">
       </path>
      </svg>
      Join Room
     </button>
     <button class="btn btn-success" onclick="showPublicRooms()">
      <svg class="icon" viewbox="0 0 24 24">
       <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,14L6,9L7.41,7.59L11,11.17L16.59,5.58L18,7L11,14Z">
       </path>
      </svg>
      Browse Public
     </button>
    </div>
   </div>
   <!-- Create Room Modal -->
   <div class="modal" id="createRoomModal" style="display: none;">
    <div class="modal-content">
     <h2>
      Create New Room
     </h2>
     <div class="form-group">
      <label>
       Your Display Name
      </label>
      <input id="createUsername" placeholder="Enter your username" required="" type="text"/>
     </div>
     <div class="form-group">
      <label>
       Room Name
      </label>
      <input id="roomName" placeholder="Enter room name" required="" type="text"/>
     </div>
     <div class="form-group">
      <label>
       Password (Optional)
      </label>
      <input id="roomPassword" placeholder="Leave blank for no password" type="password"/>
     </div>
     <div class="form-group">
      <label>
       Room Type
      </label>
      <select id="roomType">
       <option value="private">
        Private Room
       </option>
       <option value="public">
        Public Room
       </option>
      </select>
     </div>
     <button class="btn" onclick="createRoom()">
      <svg class="icon" viewbox="0 0 24 24">
       <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z">
       </path>
      </svg>
      Create Room
     </button>
     <button class="btn btn-secondary" onclick="showWelcome()">
      <svg class="icon" viewbox="0 0 24 24">
       <path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z">
       </path>
      </svg>
      Back
     </button>
    </div>
   </div>
   <!-- Join Room Modal -->
   <div class="modal" id="joinRoomModal" style="display: none;">
    <div class="modal-content">
     <h2>
      Join Room
     </h2>
     <div class="form-group">
      <label>
       Your Display Name
      </label>
      <input id="joinUsername" placeholder="Enter your username" required="" type="text"/>
     </div>
     <div class="form-group">
      <label>
       Room ID
      </label>
      <input id="joinRoomId" placeholder="Enter room ID" required="" type="text"/>
     </div>
     <div class="form-group">
      <label>
       Password (if required)
      </label>
      <input id="joinPassword" placeholder="Enter password if required" type="password"/>
     </div>
     <button class="btn" onclick="joinRoom()">
      <svg class="icon" viewbox="0 0 24 24">
       <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z">
       </path>
      </svg>
      Join Room
     </button>
     <button class="btn btn-secondary" onclick="showWelcome()">
      <svg class="icon" viewbox="0 0 24 24">
       <path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z">
       </path>
      </svg>
      Back
     </button>
    </div>
   </div>
   <!-- Public Rooms Modal -->
   <div class="modal" id="publicRoomsModal" style="display: none;">
    <div class="modal-content">
     <h2>
      Public Chat Rooms
     </h2>
     <div class="form-group">
      <label>
       Your Display Name
      </label>
      <input id="publicUsername" placeholder="Enter your username" required="" type="text"/>
     </div>
     <div class="rooms-list" id="publicRoomsList">
      <div class="loading">
      </div>
     </div>
     <button class="btn btn-secondary" onclick="showWelcome()">
      <svg class="icon" viewbox="0 0 24 24">
       <path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z">
       </path>
      </svg>
      Back
     </button>
     <button class="btn" onclick="refreshPublicRooms()">
      <svg class="icon" viewbox="0 0 24 24">
       <path d="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z">
       </path>
      </svg>
      Refresh
     </button>
    </div>
   </div>
   <!-- Room Created Modal -->
   <div class="modal" id="roomCreatedModal" style="display: none;">
    <div class="modal-content">
     <h2>
      Room Created Successfully!
     </h2>
     <div class="share-info">
      <p>
       <strong>
        Room Name:
       </strong>
       <span id="createdRoomName">
       </span>
      </p>
      <p>
       <strong>
        Room ID:
       </strong>
       <span id="createdRoomId">
       </span>
      </p>
      <p>
       <strong>
        Share URL:
       </strong>
      </p>
      <div class="share-url" id="shareUrl">
      </div>
      <button class="btn copy-btn" onclick="copyShareUrl()">
       <svg class="icon" viewbox="0 0 24 24">
        <path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z">
        </path>
       </svg>
       Copy Link
      </button>
     </div>
     <button class="btn" onclick="joinCreatedRoom()">
      <svg class="icon" viewbox="0 0 24 24">
       <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z">
       </path>
      </svg>
      Join Room Now
     </button>
     <button class="btn btn-secondary" onclick="showWelcome()">
      <svg class="icon" viewbox="0 0 24 24">
       <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z">
       </path>
      </svg>
      Create Another
     </button>
    </div>
   </div>
   <!-- Chat Interface -->
   <div class="chat-container" id="chatContainer">
    <div class="chat-header">
     <h1 id="chatRoomName">
      Chat Room
     </h1>
     <div class="user-info" id="roomInfo">
      Connected as
      <span id="currentUsername">
      </span>
     </div>
    </div>
    <div class="messages-container" id="messagesContainer">
     <!-- Messages will be inserted here -->
    </div>
    <div class="typing-indicator" id="typingIndicator">
     <span id="typingText">
      Someone is typing
     </span>
     <div class="typing-dots">
      <span class="typing-dot">
      </span>
      <span class="typing-dot">
      </span>
      <span class="typing-dot">
      </span>
     </div>
    </div>
    <div class="input-area">
     <div class="reply-preview" id="replyPreview">
      <span class="close-reply" onclick="cancelReply()">
       ×
      </span>
      <div id="replyContent">
      </div>
     </div>
     <div class="input-container">
      <textarea class="message-input" id="messageInput" placeholder="Type your message..." rows="1"></textarea>
      <input accept="image/*,video/*,.gif" class="file-input" id="fileInput" onchange="handleFileSelect(event)" type="file"/>
      <button class="action-btn file-btn" onclick="document.getElementById('fileInput').click()" title="Attach Media">
       <svg class="icon" viewbox="0 0 24 24">
        <path d="M16.5,6V17.5A4,4 0 0,1 12.5,21.5A4,4 0 0,1 8.5,17.5V5A2.5,2.5 0 0,1 11,2.5A2.5,2.5 0 0,1 13.5,5V15.5A1,1 0 0,1 12.5,16.5A1,1 0 0,1 11.5,15.5V6H10V15.5A2.5,2.5 0 0,0 12.5,18A2.5,2.5 0 0,0 15,15.5V5A4,4 0 0,0 11,1A4,4 0 0,0 7,5V17.5A5.5,5.5 0 0,0 12.5,23A5.5,5.5 0 0,0 18,17.5V6H16.5Z">
        </path>
       </svg>
      </button>
      <button class="action-btn send-btn" onclick="sendMessage()" title="Send Message">
       <svg class="icon" viewbox="0 0 24 24">
        <path d="M2,21L23,12L2,3V10L17,12L2,14V21Z">
        </path>
       </svg>
      </button>
     </div>
    </div>
   </div>
  </div>
  <!-- Image Preview Modal -->
  <div class="image-preview" id="imagePreview">
   <span class="close-preview" onclick="closeImagePreview()">
    ×
   </span>
   <img alt="Preview" id="previewImage" src=""/>
  </div>
  <script src="/socket.io/socket.io.js">
  </script>
  <script src="script.js">
  </script>
 </body>
</html>
